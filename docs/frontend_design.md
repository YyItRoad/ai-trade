# 前端页面设计文档 (v2)

本文档根据最新需求进行修订，将页面设计从展示单条最新结果，改为以列表形式展示所有历史分析记录。

## 1. 页面目标

-   以表格形式清晰地展示所有历史分析记录。
-   支持分页功能，方便用户浏览大量数据。
-   页面应能自动刷新并跳转到第一页，以展示最新的分析结果。

## 2. 页面线框图 (Wireframe)

```
+----------------------------------------------------------------------------------+
| AI Trade Analysis History                                                        |
+----------------------------------------------------------------------------------+
|                                                                                  |
|  +------------------------------------------------------------------------------+  |
|  | [Filter controls could go here in the future, e.g., by asset or date range]  |  |
|  +------------------------------------------------------------------------------+  |
|                                                                                  |
|  <-- Table of Analysis Results -->                                               |
|  +----------+------------+-----------+-------------+----------+-----------------+  |
|  | Timestamp| Direction  | Entry     | Stop Loss   | TP 1     | Details         |  |
|  +----------+------------+-----------+-------------+----------+-----------------+  |
|  | 23-10-27 | LONG       | 12345.67  | 12000.00    | 13500.00 | [View Details]  |  |
|  +----------+------------+-----------+-------------+----------+-----------------+  |
|  | 23-10-26 | SHORT      | 12800.10  | 13000.50    | 12500.00 | [View Details]  |  |
|  +----------+------------+-----------+-------------+----------+-----------------+  |
|  | ...      | ...        | ...       | ...         | ...      | ...             |  |
|  +----------+------------+-----------+-------------+----------+-----------------+  |
|                                                                                  |
|  <-- Pagination Controls -->                                                     |
|  +------------------------------------------------------------------------------+  |
|  | << First | < Prev | Page 1 of 10 | Next > | Last >>                         |  |
|  +------------------------------------------------------------------------------+  |
|                                                                                  |
+----------------------------------------------------------------------------------+
```

## 3. 组件详解

-   **Header**:
    -   显示页面标题 "AI Trade Analysis History"。
-   **Results Table**:
    -   一个 HTML `<table>` 元素，用于展示分析记录列表。
    -   **表头 (Columns)**: 至少包含 `Timestamp`, `Direction`, `Entry Point`, `Stop Loss`, `Take Profit 1` 等关键信息，以便快速浏览。
    -   **行 (Rows)**: 每一行代表一条分析记录。`Direction` 单元格的文本颜色可以根据 `LONG` (绿色) 或 `SHORT` (红色) 动态变化。
    -   **Details Button**: 每一行末尾有一个 "View Details" 按钮。点击该按钮可以弹出一个模态窗口（Modal）或展开一个可折叠区域，显示该条记录的**所有**详细信息（如 Confidence, R/R Ratio, Wave Analysis, Rationale 等）。
-   **Pagination Controls**:
    -   一组按钮，用于在数据页之间导航。
    -   应显示当前页码和总页数。
    -   当用户在第一页或最后一页时，"Prev" 或 "Next" 按钮应被禁用。

## 4. 数据交互

-   **`script.js`** 将负责以下逻辑：
    1.  **`fetchData(page = 1, size = 20)` 函数**:
        -   使用 `fetch` API 异步请求 `/analysis-history?page=${page}&size=${size}` 端点。
        -   成功获取数据后，调用 `updateTable()` 和 `updatePagination()` 函数。
    2.  **`updateTable(records)` 函数**:
        -   接收分析记录数组作为参数。
        -   清空现有的表格内容。
        -   遍历记录数组，为每条记录动态创建一行 (`<tr>`) 和相应的单元格 (`<td>`)，并添加到表格中。
        -   为每一行的 "View Details" 按钮绑定点击事件监听器，用于显示详细信息。
    3.  **`updatePagination(currentPage, totalPages)` 函数**:
        -   根据当前页和总页数，更新分页控件的显示状态（例如，哪个页码是激活的，哪些按钮是禁用的）。
        -   为分页按钮绑定点击事件，点击后调用 `fetchData()` 请求新的页面数据。
    4.  **自动刷新**:
        -   使用 `setInterval(() => fetchData(1), 60000)` 设置定时器，每 60 秒自动请求并显示第一页的最新数据。

## 5. 样式与布局 (CSS)

-   **`style.css`** 将定义页面的外观：
    -   为表格提供清晰的样式（边框、间距、斑马条纹等）。
    -   为 "View Details" 模态窗口或可折叠区域设计样式。
    -   为分页控件设计清晰、易用的样式。